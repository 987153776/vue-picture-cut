(function(t){function i(i){for(var a,h,o=i[0],c=i[1],r=i[2],l=0,v=[];l<o.length;l++)h=o[l],Object.prototype.hasOwnProperty.call(s,h)&&s[h]&&v.push(s[h][0]),s[h]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(t[a]=c[a]);u&&u(i);while(v.length)v.shift()();return n.push.apply(n,r||[]),e()}function e(){for(var t,i=0;i<n.length;i++){for(var e=n[i],a=!0,o=1;o<e.length;o++){var c=e[o];0!==s[c]&&(a=!1)}a&&(n.splice(i--,1),t=h(h.s=e[0]))}return t}var a={},s={app:0},n=[];function h(i){if(a[i])return a[i].exports;var e=a[i]={i:i,l:!1,exports:{}};return t[i].call(e.exports,e,e.exports,h),e.l=!0,e.exports}h.m=t,h.c=a,h.d=function(t,i,e){h.o(t,i)||Object.defineProperty(t,i,{enumerable:!0,get:e})},h.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},h.t=function(t,i){if(1&i&&(t=h(t)),8&i)return t;if(4&i&&"object"===typeof t&&t&&t.__esModule)return t;var e=Object.create(null);if(h.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:t}),2&i&&"string"!=typeof t)for(var a in t)h.d(e,a,function(i){return t[i]}.bind(null,a));return e},h.n=function(t){var i=t&&t.__esModule?function(){return t["default"]}:function(){return t};return h.d(i,"a",i),i},h.o=function(t,i){return Object.prototype.hasOwnProperty.call(t,i)},h.p="";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],c=o.push.bind(o);o.push=i,o=o.slice();for(var r=0;r<o.length;r++)i(o[r]);var u=c;n.push([0,"chunk-vendors"]),e()})({0:function(t,i,e){t.exports=e("cd49")},"5c0b":function(t,i,e){"use strict";var a=e("9c0c"),s=e.n(a);s.a},"823b":function(t,i,e){"use strict";var a=e("972a"),s=e.n(a);s.a},"972a":function(t,i,e){},"9c0c":function(t,i,e){},cd49:function(t,i,e){"use strict";e.r(i);e("e260"),e("e6cf"),e("cca6"),e("a79d");var a=e("2b0e"),s=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{attrs:{id:"app"}},[e("input",{attrs:{type:"file",accept:"image/*"},on:{change:t.inputChange}}),e("a",{style:{"background-image":"url("+t.base64+")"},attrs:{download:"xxx.jpeg",href:t.base64}},[t._v("处理后预览")]),e("vue-picture-cut",{staticClass:"cut",attrs:{src:t.src},on:{"on-change":t.cutChange}})],1)},n=[],h=(e("d3b7"),e("3ca3"),e("ddb0"),e("2b3d"),e("d4ec")),o=e("bee2"),c=e("262e"),r=e("2caf"),u=e("9ab4"),l=e("60a3"),v=function(t){Object(c["a"])(e,t);var i=Object(r["a"])(e);function e(){var t;return Object(h["a"])(this,e),t=i.apply(this,arguments),t.src=null,t.blob=null,t.base64=null,t}return Object(o["a"])(e,[{key:"inputChange",value:function(t){var i=t.target.files[0];this.src=URL.createObjectURL(i)}},{key:"cutChange",value:function(t){var i=t.blob,e=t.base64;this.blob=i,this.base64=e}}]),e}(l["e"]);v=Object(u["a"])([l["a"]],v);var d=v,f=d,p=(e("5c0b"),e("2877")),g=Object(p["a"])(f,s,n,!1,null,null,null),y=g.exports,w=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"vue-picture-cut"},[e("div",{ref:"conso",staticClass:"vue-picture-cut_console"}),t.choose?e("div",{staticClass:"vue-picture-cut_header"},[e("i",{staticClass:"vue-picture-cut_load-bt v-p-icon v-p-icon_import",on:{click:function(i){t.loadBoxShow=!t.loadBoxShow}}}),e("transition",{attrs:{name:"vue-picture-cut_mask"}},[e("div",{directives:[{name:"show",rawName:"v-show",value:t.loadBoxShow,expression:"loadBoxShow"}],staticClass:"vue-picture-cut_mask",on:{click:function(i){t.loadBoxShow=!1}}})]),e("transition",{attrs:{name:"vue-picture-cut_load"}},[e("div",{directives:[{name:"show",rawName:"v-show",value:t.loadBoxShow,expression:"loadBoxShow"}],staticClass:"vue-picture-cut_load-box"},[e("div",{staticClass:"vue-picture-cut_load-title v-p_1px-b"},[t._v("选择图片")]),e("form",{ref:"form"},[e("div",{staticClass:"vue-picture-cut_load-item v-p_1px-b"},[t._v("拍照 "),e("input",{attrs:{type:"file",accept:"image/*",capture:"camera",name:"file"},on:{change:t.myChange}})]),e("div",{staticClass:"vue-picture-cut_load-item v-p_1px-b"},[t._v("从相册中选择图片 "),e("input",{attrs:{type:"file",accept:"image/*",name:"file"},on:{change:t.myChange}})])]),e("div",{staticClass:"vue-picture-cut_load-close",on:{click:function(i){t.loadBoxShow=!1}}},[t._v("取消")])])])],1):t._e(),e("div",{ref:"main",staticClass:"vue-picture-cut_main"},[e("canvas",{ref:"canvas",staticClass:"vue-picture-cut_canvas"})]),e("div",{staticClass:"vue-picture-cut_menu-box"},[e("div",{staticClass:"vue-picture-cut_menu1"},[e("div",{staticClass:"flex-center"},[e("button",{staticClass:"vue-picture-cut_menu1-item",class:{active:"clip"===t.status},attrs:{disabled:-1===["all","clip"].indexOf(t.status)},on:{click:t.clip}},[e("i",{staticClass:"v-p-icon v-p-icon_clip"}),e("div",[t._v("剪裁")])]),e("button",{staticClass:"vue-picture-cut_menu1-item",attrs:{disabled:-1===["all"].indexOf(t.status)},on:{click:function(i){return t.rotate(-.5)}}},[e("i",{staticClass:"v-p-icon v-p-icon_rotateLeft"}),e("div",[t._v("左旋转")])]),e("button",{staticClass:"vue-picture-cut_menu1-item",attrs:{disabled:-1===["all"].indexOf(t.status)},on:{click:function(i){return t.rotate(.5)}}},[e("i",{staticClass:"v-p-icon v-p-icon_rotateRight"}),e("div",[t._v("右旋转")])]),e("button",{staticClass:"vue-picture-cut_menu1-item",attrs:{disabled:-1===["all"].indexOf(t.status)},on:{click:function(i){return t.flip(!1)}}},[e("i",{staticClass:"v-p-icon v-p-icon_flipV"}),e("div",[t._v("上下翻转")])]),e("button",{staticClass:"vue-picture-cut_menu1-item",attrs:{disabled:-1===["all"].indexOf(t.status)},on:{click:function(i){return t.flip(!0)}}},[e("i",{staticClass:"v-p-icon v-p-icon_flipH"}),e("div",[t._v("水平翻转")])])])]),e("div",{staticClass:"vue-picture-cut_menu2"},[e("button",{staticClass:"v-p-icon v-p-icon_cancel usable",on:{click:t.close}}),e("button",{staticClass:"v-p-icon v-p-icon_sure usable",attrs:{disabled:""===t.status},on:{click:t.sure}}),e("button",{staticClass:"vue-picture-cut_menu2_reset",attrs:{disabled:null===t.oldSrc},on:{click:t.reset}},[t._v("还原")])])])])},m=[],b=e("b85c"),k=(e("4160"),e("159b"),e("25f0"),function(t){return Object.prototype.toString.call(t)}),x=function(){function t(){Object(h["a"])(this,t),this.pStart={x:0,y:0},this.pEnd={x:1,y:1},this.pCrt1={x:0,y:0},this.pCrt2={x:0,y:0},this.setOptByString("ease")}return Object(o["a"])(t,[{key:"setOpt",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"ease";if("[object Array]"===k(t)&&t.length>=4){var i=t;return this.setOptByArr(i[0],i[1],i[2],i[3])}return"[object String]"===k(t)?this.setOptByString(t):this.setOptByString("ease")}},{key:"setOptByString",value:function(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"ease",e=t.BEZIER[i];return void 0===e&&(e=t.BEZIER.ease),this.setOptByArr(e[0],e[1],e[2],e[3])}},{key:"setOptByArr",value:function(t,i,e,a){return this.pCrt1={x:t,y:i},this.pCrt2={x:e,y:a},this}},{key:"getPoint",value:function(t){var i=[1,t,t*t,t*t*t],e=[[1,0,0,0],[-3,3,0,0],[3,-6,3,0],[-1,3,-3,1]],a=[[this.pStart.x,this.pStart.y],[this.pCrt1.x,this.pCrt1.y],[this.pCrt2.x,this.pCrt2.y],[this.pEnd.x,this.pEnd.y]],s=[i[0]*e[0][0]+i[1]*e[1][0]+i[2]*e[2][0]+i[3]*e[3][0],i[0]*e[0][1]+i[1]*e[1][1]+i[2]*e[2][1]+i[3]*e[3][1],i[0]*e[0][2]+i[1]*e[1][2]+i[2]*e[2][2]+i[3]*e[3][2],i[0]*e[0][3]+i[1]*e[1][3]+i[2]*e[2][3]+i[3]*e[3][3]],n=[s[0]*a[0][0]+s[1]*a[1][0]+s[2]*a[2][0]+s[3]*a[3][0],s[0]*a[0][1]+s[1]*a[1][1]+s[2]*a[2][1]+s[3]*a[3][1]],h={x:n[0],y:n[1]};return h.y}}]),t}();x.BEZIER={linear:[0,0,1,1],ease:[.25,.1,.25,1],"ease-in":[.42,0,1,1],"ease-out":[0,0,.58,1],"ease-in-out":[.42,0,.58,1]};var _=new x,C=function(){function t(i){Object(h["a"])(this,t),this.duration=1e3,this.timing="ease",this.delay=0,this.iteration=1,this.direction="normal",this.change=function(){return!1},this.end=function(){},this.startTime=0,this.id=0,void 0!==i.duration&&(this.duration=i.duration),void 0!==i.timing&&(this.timing=i.timing),void 0!==i.delay&&(this.delay=i.delay),void 0!==i.iteration&&(this.iteration=i.iteration),void 0!==i.direction&&(this.direction=i.direction),void 0!==i.change&&(this.change=i.change),void 0!==i.end&&(this.end=i.end);var e="infinite"===this.iteration?9999999999999:this.iteration*this.duration;this.times="alternate"===this.direction||"alternate-reverse"===this.direction?2*e:e,_.setOpt(this.timing)}return Object(o["a"])(t,[{key:"start",value:function(){var t=this;return this.startTime=0,this.delay?setTimeout((function(){t.startTime=Date.now(),t._do()}),this.delay):(this.startTime=Date.now(),this._do()),this}},{key:"_do",value:function(){var t=this;this.id=requestAnimationFrame((function(){var i=Date.now()-t.startTime,e=i/t.duration,a=parseInt(String(e));switch(e-=a,t.direction){case"normal":e=i<t.times?e:1;break;case"reverse":e=i<t.times?1-e:0;break;case"alternate":e=a%2?i<t.times?1-e:0:i<t.times?e:1,a/2===t.iteration&&(e=0);break;case"alternate-reverse":e=a%2?i<t.times?e:1:i<t.times?1-e:0,a/2===t.iteration&&(e=1);break}var s=_.getPoint(e),n=t.change(s);!1!==n&&i<t.times?t._do():t.end()}))}},{key:"abort",value:function(){this.id>0&&cancelAnimationFrame(this.id),this.id=0}}]),t}();function O(t){return new C(t)}var S=document.createElement("canvas"),j=S.getContext("2d"),B={copyImageData:function(t,i){var e=t.createImageData(i.width,i.height);return e.data.set(i.data),e},colorInvertProcess:function(t,i){for(var e=0;e<i;e+=4){var a=t[e],s=t[e+1],n=t[e+2];t[e]=255-a,t[e+1]=255-s,t[e+2]=255-n}},colorAdjustProcess:function(t,i){for(var e=0;e<i;e+=4){var a=t[e],s=t[e+1],n=t[e+2];t[e]=.272*a+.534*s+.131*n,t[e+1]=.349*a+.686*s+.168*n,t[e+2]=.393*a+.769*s+.189*n}},blurProcess:function(t,i){for(var e=this.copyImageData(t,i),a=0,s=0,n=0,h=0;h<e.width;h++)for(var o=0;o<e.height;o++){for(var c=4*(h+o*e.width),r=-2;r<=2;r++){var u=r+h;(u<0||u>=e.width)&&(u=0);for(var l=-2;l<=2;l++){var v=l+o;(v<0||v>=e.height)&&(v=0);var d=4*(u+v*e.width),f=e.data[d+0],p=e.data[d+1],g=e.data[d+2];a+=f,s+=p,n+=g}}var y=a/25,w=s/25,m=n/25;a=0,s=0,n=0,i.data[c+0]=y,i.data[c+1]=w,i.data[c+2]=m,i.data[c+3]=255}},reliefProcess:function(t,i){for(var e=this.copyImageData(t,i),a=1;a<e.width-1;a++)for(var s=1;s<e.height-1;s++){var n=4*(a+s*e.width),h=4*(a-1+s*e.width),o=4*(a+1+s*e.width),c=e.data[o+0]-e.data[h+0]+128,r=e.data[o+1]-e.data[h+1]+128,u=e.data[o+2]-e.data[h+2]+128;c=c<0?0:c>255?255:c,r=r<0?0:r>255?255:r,u=u<0?0:u>255?255:u,i.data[n+0]=c,i.data[n+1]=r,i.data[n+2]=u,i.data[n+3]=255}},diaokeProcess:function(t,i){for(var e=this.copyImageData(t,i),a=1;a<e.width-1;a++)for(var s=1;s<e.height-1;s++){var n=4*(a+s*e.width),h=4*(a-1+s*e.width),o=4*(a+1+s*e.width),c=e.data[h+0]-e.data[o+0]+128,r=e.data[h+1]-e.data[o+1]+128,u=e.data[h+2]-e.data[o+2]+128;c=c<0?0:c>255?255:c,r=r<0?0:r>255?255:r,u=u<0?0:u>255?255:u,i.data[n+0]=c,i.data[n+1]=r,i.data[n+2]=u,i.data[n+3]=255}},mirrorProcess:function(t,i){for(var e=this.copyImageData(t,i),a=0;a<e.width;a++)for(var s=0;s<e.height;s++){var n=4*(a+s*e.width),h=4*(e.width-1-a+s*e.width);i.data[h+0]=e.data[n+0],i.data[h+1]=e.data[n+1],i.data[h+2]=e.data[n+2],i.data[h+3]=255}},rotateProcess:function(t,i){var e=t.width,a=t.height;return S.width=a,S.height=e,j.clearRect(0,0,a,e),j.save(),j.translate(a/2,e/2),j.rotate(i*Math.PI),j.drawImage(t,-e/2,-a/2,e,a),j.restore(),S.toDataURL("image/jpeg",.95)},flipProcess:function(t,i){var e=t.width,a=t.height;return S.width=e,S.height=a,j.save(),j.scale(i?-1:1,i?1:-1),j.drawImage(t,i?-t.width:0,i?0:-t.height,t.width,t.height),j.restore(),S.toDataURL("image/jpeg",.95)}},P=(e("c19f"),e("b0c0"),e("ac1f"),e("1276"),e("5cc6"),e("9a8c"),e("a975"),e("735e"),e("c1ac"),e("d139"),e("3a7b"),e("d5d6"),e("82f8"),e("e91f"),e("60bd"),e("5f96"),e("3280"),e("3fcc"),e("ca91"),e("25a1"),e("cd26"),e("3c5d"),e("2954"),e("649e"),e("219c"),e("170b"),e("b39a"),e("72f7"),e("9072")),M=(Window,document.createElement("canvas"));M.style.display="none";var L=M.getContext("2d"),R={loadImg:function(t){return new Promise((function(i,e){var a=new Image;a.addEventListener("load",(function(){i&&i(a)})),a.addEventListener("error",(function(){e&&e(a)})),a.src=t}))},clipBy:function(t,i,e,a,s,n,h,o,c){var r=arguments.length>9&&void 0!==arguments[9]?arguments[9]:.8,u=arguments.length>10&&void 0!==arguments[10]?arguments[10]:"image/jpeg";return M.width=o,M.height=c,L.clearRect(0,0,o,c),L.drawImage(t,i,e,a,s,n,h,o,c),M.toDataURL(u,r)},clipByMax:function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2e3,e=t.width/t.height,a=t.width,s=t.height;t.width>i&&(a=i,s=a/e),t.height>i&&(s=i,a=s*e);var n=this.clipBy(t,0,0,t.width,t.height,0,0,a,s,.9);return{src:n,file:this.base64ToBlob(n)}},base64ToBlob:function(t){for(var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"image/jpeg",e=atob(t.split(",")[1]),a=new ArrayBuffer(e.length),s=new Uint8Array(a),n=0,h=e.length;n<h;n++)s[n]=255&e.charCodeAt(n);var o=null;try{o=new Blob([s],{type:i})}catch(l){var c=window,r=c.BlobBuilder||c.WebKitBlobBuilder||c.MozBlobBuilder||c.MSBlobBuilder;if("TypeError"===l.name&&r){var u=new r;u.append(s.buffer),o=u.getBlob(i)}else"InvalidStateError"===l.name&&(o=new Blob([a],{type:i}))}return o}},T=function(){function t(i){Object(h["a"])(this,t),this.isCan=!1,this.status=null,this.isLoad=!1,this.x=0,this.y=0,this.w=0,this.h=0,this.cx=0,this.cy=0,this.minX=0,this.minY=0,this.maxX=0,this.maxY=0,this.isThisCreate=!1,this.mCore={x:0,y:0},this.touch=[],this.touchstart={x:0,y:0},this.touchstartlength=0,this.wheelData={x:0,y:0,zoom:1},this.animation=void 0,this.img=null,this.src=void 0,this.wheelAnimation=void 0,this.pc=i,this.cw=this.pc.width,this.ch=this.pc.height,this.core={x:this.cw/2,y:this.ch/2}}return Object(o["a"])(t,[{key:"setSrc",value:function(t){var i=this;this.src=t,this.isCan=!1,this.isLoad=!1,R.loadImg(t).then((function(t){t=t;var e=i.checkImgSize(t);e?i.setSrc(e):(i.img=t,i.x=0,i.y=0,i.w=t.width,i.h=t.height,i.minX||i.setMoveRange(),i._initRect(),i._checkRange(),i.isCan=!0,i.isLoad=!0,i.pc.draw())}),(function(){console.error("加载图片出错！")}))}},{key:"checkImgSize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=t||this.img;if(null!==i){var e=2e3,a=i.width/i.height;if(i.width<=e&&i.height<=e)return null;var s=0,n=0;return i.width>e&&(s=e,n=s/a),i.height>e&&(n=e,s=n*a),R.clipBy(i,0,0,i.width,i.height,0,0,s,n,.9)}}},{key:"setMoveRange",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(this.isThisCreate=!1,!t||!i||!e||!a){var s=this.w,n=this.h;if(!s)return;var h=this.pc.width,o=this.pc.height,c=h/o,r=s/n;if(c>r){var u=o*r;t=(h-u)/2,i=0,e=t+u,a=o}else{var l=h/r;t=0,i=(o-l)/2,e=h,a=i+l}this.isThisCreate=!0}this.minX=t,this.minY=i,this.maxX=e,this.maxY=a,this.core={x:(e+t)/2,y:(a+i)/2},this.img&&this._checkRange()}},{key:"_initRect",value:function(){var t=this.pc.width,i=this.pc.height,e=this.w,a=this.h,s=e/t,n=a/i,h=s<n?n:s;this.cw=e/h,this.ch=a/h,this.cx=(t-this.cw)/2,this.cy=(i-this.ch)/2,this.core={x:this.cx,y:this.cy}}},{key:"touchMove1",value:function(t){"move"===this.status&&(this.touch[0]=t),this.draw()}},{key:"touchMove2",value:function(t,i){"scale"===this.status&&(this.touch=[t,i]),this.draw()}},{key:"touchMove3",value:function(t){this.draw()}},{key:"mouseWheel",value:function(t,i,e){var a,s=this;null===(a=this.wheelAnimation)||void 0===a||a.abort(),this.status="wheel",this.wheelData={x:i,y:e,zoom:t};var n=this.cx,h=this.cy,o=this.cw,c=this.ch;this.scaleByZoom2(t,i,e);var r=this.cx-n,u=this.cy-h,l=this.cw-o,v=this.ch-c;this.isCan=!1,this.wheelAnimation=O({duration:50,timing:"linear",change:function(t){if(s.cx=n+t*r,s.cy=h+t*u,s.cw=o+t*l,s.ch=c+t*v,s.core={x:s.cx+s.cw/2,y:s.cy+s.ch/2},s.pc.draw(),s.isCan)return!1},end:function(){s.isCan=!0}}).start()}},{key:"_touchStart",value:function(t){var i;null===(i=this.animation)||void 0===i||i.abort(),1===this.touch.length?this.touch[0].id!==t.id&&(this.touch.push(t),this._touchStart2(this.touch[0],this.touch[1])):0===this.touch.length&&(this.touch.push(t),this._touchStart1(t))}},{key:"_touchStart1",value:function(t){this.status="move",this.touchstart=this._getPointerLocation(t.x,t.y)}},{key:"_touchStart2",value:function(t,i){this.status="scale";var e=t.x,a=t.y,s=i.x,n=i.y;this.touchstart=this._getPointerLocation((e+s)/2,(a+n)/2),this.touchstartlength=this._getPointLength(e,a,s,n)}},{key:"_touchEnd",value:function(t){if(0!==this.touch.length){var i=[];this.touch.forEach((function(e){e.id!==t.id&&i.push(e)})),0===i.length?(this.touchstartlength=0,this.status="",this.touchstart={x:0,y:0},this._checkRange()):1===i.length&&(this.status="",this._touchStart1(i[0])),this.touch=i}}},{key:"draw",value:function(){this.isLoad&&(2===this.touch.length&&"scale"===this.status?this.scaleByLocation(this.touch[1].x,this.touch[1].y,this.touch[0].x,this.touch[0].y):"move"===this.status&&this.move(this.touch[0].x,this.touch[0].y),this.pc.drawImg(this.img,this.x,this.y,this.w,this.h,this.cx,this.cy,this.cw,this.ch))}},{key:"scaleByLocation",value:function(t,i,e,a){if(this.isCan){var s=this._getPointLength(t,i,e,a);if(this.touchstartlength||(this.touchstartlength=s),this.touchstartlength){var n=s/this.touchstartlength;n=n<.9091?.9091:n,n=n>1.1?1.1:n,this.scaleByZoom(n,(t+e)/2,(i+a)/2),this.touchstartlength=s}}}},{key:"scaleByZoom",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=arguments.length>1?arguments[1]:void 0,e=arguments.length>2?arguments[2]:void 0;if(this.isCan){var a=this.touchstart;a={x:a.x*t,y:a.y*t},this.touchstart=a;var s=this.cw,n=this.ch,h=s*t,o=n*t,c=(s-h)/2,r=(n-o)/2;this.cx=i?i-a.x:c,this.cy=e?e-a.y:r,this.cw=h,this.ch=o,this.core={x:c+h/2,y:r+o/2}}}},{key:"scaleByZoom2",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=arguments.length>1?arguments[1]:void 0,e=arguments.length>2?arguments[2]:void 0;this.cx=i+(this.cx-i)*t,this.cy=e+(this.cy-e)*t,this.cw=this.cw*t,this.ch=this.ch*t,this.core={x:this.cx+this.cw/2,y:this.cy+this.ch/2}}},{key:"move",value:function(t,i){if(this.isCan){var e=this.touchstart,a=t-e.x,s=i-e.y;this.cx=a,this.cy=s,this.core={x:a+this.cw/2,y:s+this.ch/2}}}},{key:"_checkRange",value:function(){var t=this.w,i=this.h,e=this.cx,a=this.cy,s=this.cw,n=this.ch,h=this.minX,o=this.minY,c=this.maxX,r=this.maxY,u=e,l=a,v=s,d=n,f=this._getPohtoByRangeLocation(),p=f[0],g=f[1],y=f[2],w=f[3],m=f[4],b=f[5],k=t/i;m<=0&&(v=c-h,d=v/k,u=e+(s-v)/2,l=a+(n-d)/2),f=this._getPohtoByRangeLocation([u,l,v,d]),p=f[0],g=f[1],y=f[2],w=f[3],m=f[4],b=f[5],b<=0&&(d=r-o,v=d*k,u=e+(s-v)/2,l=a+(n-d)/2),f=this._getPohtoByRangeLocation([u,l,v,d]),p=f[0],g=f[1],y=f[2],w=f[3],m=f[4],b=f[5],p>0&&(u-=p),g>0&&(l-=g),y<0&&(u-=y),w<0&&(l-=w),this._animation(u-e,l-a,v-s,d-n)}},{key:"_animation",value:function(t,i,e,a){var s=this;this.isCan=!1;var n=this.cx,h=this.cy,o=this.cw,c=this.ch;this.animation=O({duration:300,timing:"ease-in-out",change:function(r){if(s.cx=n+r*t,s.cy=h+r*i,s.cw=o+r*e,s.ch=c+r*a,s.core={x:s.cx+s.cw/2,y:s.cy+s.ch/2},s.pc.draw(),s.isCan)return!1},end:function(){s.isCan=!0}}).start()}},{key:"clip",value:function(){if(this.img){var t=this._getPohtoByRangeLocation(),i=t[0],e=t[1],a=this.maxX-this.minX,s=this.maxY-this.minY,n=this.w/this.cw,h=0-i*n,o=0-e*n,c=a*n,r=s*n,u=R.clipBy(this.img,h,o,c,r,0,0,a,s);return{src:u,file:R.base64ToBlob(u)}}}},{key:"rotate",value:function(t){var i=B.rotateProcess(this.img,t);this.isThisCreate&&(this.minX=null),this.setSrc(i)}},{key:"flip",value:function(t){var i=B.flipProcess(this.img,t);this.isThisCreate&&(this.minX=null),this.setSrc(i)}},{key:"filter",value:function(t){var i=this;t(this.img,(function(t){R.loadImg(t).then((function(t){i.img=t,i.pc.draw()}))}))}},{key:"_isHover",value:function(t,i){var e=this.getRect();return t>=e[0]&&i>=e[1]&&t<=e[2]&&i<=e[3]}},{key:"_getPointerLocation",value:function(t,i){return{x:t-this.cx,y:i-this.cy}}},{key:"_getPohtoByRangeLocation",value:function(t){var i=this.cx,e=this.cy,a=this.cw,s=this.ch,n=this.minX,h=this.minY,o=this.maxX,c=this.maxY;return t&&(i=t[0],e=t[1],a=t[2],s=t[3]),[i-(n||0),e-h,i+a-o,e+s-c,a-(o-(n||0)),s-(c-h)]}},{key:"getRect",value:function(){return[this.cx,this.cy,this.cx+this.cw,this.cy+this.ch]}},{key:"_getPointLength",value:function(t,i,e,a){return Math.pow(Math.pow(t-e,2)+Math.pow(i-a,2),.5)}}]),t}(),E=(e("cb29"),function(){function t(i){Object(h["a"])(this,t),this.pc=i,this.isOpen=!1,this.x=0,this.y=0,this.w=0,this.h=0,this._initRect(),this.draw()}return Object(o["a"])(t,[{key:"_initRect",value:function(){var t=this.pc.width,i=this.pc.height;t>i?(this.w=.6*i,this.h=this.w,this.x=.5*(t-this.h),this.y=.2*i):(this.w=.6*t,this.h=this.w,this.x=.2*t,this.y=.5*(i-this.w))}},{key:"open",value:function(){this.isOpen=!0}},{key:"close",value:function(){this.isOpen=!1}},{key:"draw",value:function(){if(this.isOpen){var t=this.pc.ctx,i="rgba(0,0,0,0.6)",e=this.pc.height>this.pc.width?this.pc.height-this.h:this.pc.width-this.w;t.beginPath(),t.strokeStyle=i,t.lineWidth=e,t.strokeRect(this.x-e/2,this.y-e/2,this.w+e,this.h+e),t.closePath(),t.beginPath(),t.strokeStyle="#ff5500",t.lineWidth=2,t.strokeRect(this.x,this.y,this.w,this.h),t.closePath(),t.beginPath(),t.lineWidth=1,t.fillStyle="#ff5500",t.arc(this.pc.width/2,this.pc.height/2,6,0,2*Math.PI),t.fill(),t.closePath()}}},{key:"touchMove",value:function(t,i){this.draw()}},{key:"getRect",value:function(){return[this.x,this.y,this.w,this.h]}}]),t}()),I=function(){function t(i,e,a,s){Object(h["a"])(this,t),this.wheelTime=0,this.wheelTimeOut=0,this.wheelstutas=!1,this.canvas=i,this.magnification=1.5,this.width=e*this.magnification,this.height=a*this.magnification,this.core={x:this.width/2,y:this.height/2},this.con=s,i.width=e*this.magnification,i.height=a*this.magnification,this.ctx=i.getContext("2d"),this.ctx.save(),this.photo=new T(this),this.mask=new E(this),this.closeMask(),this._init()}return Object(o["a"])(t,[{key:"log",value:function(t){this.con&&(this.con.innerHTML="<br>"+t+this.con.innerHTML)}},{key:"setMoveRange",value:function(){var t=this.width,i=this.height;if(t>i){var e=(t-i)/2,a=t-e;this.moveRange=[e,0,a,t]}else{var s=(i-t)/2,n=i-s;this.moveRange=[0,s,i,n]}}},{key:"_init",value:function(){this._eventInit(),this.ctx&&this.clear()}},{key:"openMask",value:function(){this.mask.open();var t=this.mask.getRect();this.photo.setMoveRange(t[0],t[1],t[0]+t[2],t[1]+t[3])}},{key:"closeMask",value:function(){this.mask.close(),this.photo.setMoveRange()}},{key:"setSrc",value:function(t){this.photo.setSrc(t)}},{key:"_eventInit",value:function(){var t=this;this.canvas.addEventListener("touchstart",(function(i){if(t.photo){var e=i||window.event;e.preventDefault();var a=e.changedTouches;t._touchStart(a)}})),this.canvas.addEventListener("touchend",(function(i){if(t.photo){var e=i||window.event;e.preventDefault();var a=e.changedTouches;t._touchEnd(a)}})),this.canvas.addEventListener("touchmove",(function(i){if(t.photo){var e=i||window.event;e.preventDefault();var a=e.changedTouches;t._touchMove(a)}}));var i=!1;this.canvas.addEventListener("mousedown",(function(e){if(t.photo){var a=e||window.event;a.preventDefault(),t._mouseDown(a),i=!0}})),this.canvas.addEventListener("mouseup",(function(e){if(t.photo){var a=e||window.event;a.preventDefault(),t._mouseUp(a),i=!1}})),this.canvas.addEventListener("mousemove",(function(e){if(t.photo&&i){var a=e||window.event;a.preventDefault(),t._mouseMove(a)}})),this.canvas.addEventListener("mousewheel",(function(i){if(t.photo){var e=i||window.event,a=e.wheelDelta||e.detail;t._mouseWheel(a,e.offsetX,e.offsetY)}}))}},{key:"getClientPosition",value:function(t,i){return"HTML"===t.tagName?{x:i.x+t.offsetLeft,y:i.y+t.offsetTop}:this.getClientPosition(t.parentNode,{x:i.x+t.offsetLeft,y:i.y+t.offsetTop})}},{key:"_touchStart",value:function(t){var i=this._getTouchePoint(t[0]);this.photo._touchStart(i)}},{key:"_touchEnd",value:function(t){var i=this._getTouchePoint(t[0]);this.photo._touchEnd(i)}},{key:"_touchMove",value:function(t){this.clear();var i,e=[],a=Object(b["a"])(t);try{for(a.s();!(i=a.n()).done;){var s=i.value;e.push(this._getTouchePoint(s))}}catch(n){a.e(n)}finally{a.f()}1===e.length?this.photo.touchMove1(e[0]):2===e.length?this.photo.touchMove2(e[0],e[1]):this.photo.touchMove3(e),this.mask.touchMove()}},{key:"_mouseDown",value:function(t){var i=this._getMousePoint(t);this.photo._touchStart(i)}},{key:"_mouseUp",value:function(t){var i=this._getMousePoint(t);this.photo._touchEnd(i)}},{key:"_mouseMove",value:function(t){this.clear();var i=this._getMousePoint(t);this.photo.touchMove1(i),this.mask.touchMove()}},{key:"_mouseWheel",value:function(t,i,e){var a=this;clearTimeout(this.wheelTimeOut);var s,n=Date.now();n-this.wheelTime>200&&!this.wheelstutas&&(this.wheelstutas=!0,null===(s=this.photo.animation)||void 0===s||s.abort());this.wheelTime=n,this.wheelTimeOut=setTimeout((function(){a.wheelstutas=!1,a.photo._checkRange()}),200);var h=t>0?1.08:.92593;this.clear(),this.photo.mouseWheel(h,i*this.magnification,e*this.magnification),this.mask.touchMove()}},{key:"_isHasPoint",value:function(t,i){var e,a=null,s=Object(b["a"])(t);try{for(s.s();!(e=s.n()).done;){var n=e.value;if(n.identifier===i){a=n;break}}}catch(h){s.e(h)}finally{s.f()}return a}},{key:"_getTouchePoint",value:function(t){var i=this.getClientPosition(this.canvas,{x:0,y:0});return{x:(t.clientX-i.x)*this.magnification,y:(t.clientY-i.x)*this.magnification,id:t.identifier}}},{key:"_getMousePoint",value:function(t){return{x:t.offsetX*this.magnification,y:t.offsetY*this.magnification,id:0}}},{key:"clear",value:function(){this.ctx.clearRect(0,0,this.width,this.height)}},{key:"save",value:function(){this.ctx.save()}},{key:"restore",value:function(){this.ctx.restore()}},{key:"drawImg",value:function(t,i,e,a,s,n,h,o,c){this.ctx.drawImage(t,i,e,a,s,n,h,o,c)}},{key:"setCore",value:function(t,i){this.core={x:t,y:i},this.ctx.translate(t,i)}},{key:"resetCore",value:function(){this.ctx.translate(-this.core.x,-this.core.y)}},{key:"rotate",value:function(t,i){this.ctx.translate(t,i)}},{key:"draw",value:function(){var t;this.clear(),null===(t=this.photo)||void 0===t||t.draw(),this.mask.draw()}}]),t}(),D=function(t,i,e,a){return new I(t,i,e,a)},X=function(t){Object(c["a"])(e,t);var i=Object(r["a"])(e);function e(){var t;return Object(h["a"])(this,e),t=i.apply(this,arguments),t.loadBoxShow=!1,t.file=null,t.oldSrc=null,t.winHeight=0,t.winWidth=0,t.photoCutting=null,t.newSrc=null,t.newBlob=null,t.status="",t}return Object(o["a"])(e,[{key:"watchSrc",value:function(t){t&&(this.oldSrc=t)}},{key:"watchOldSrc",value:function(t){t&&this.photoCutting&&(this.newBlob=null,this.newSrc=null,this.setImg(t))}},{key:"watchStatus",value:function(t){if(this.photoCutting)switch(t){case"all":this.photoCutting.closeMask();break;case"clip":this.photoCutting.openMask();break}}},{key:"watchIsLoad",value:function(t){this.status=t?"all":""}},{key:"myChange",value:function(t){var i=t.target.files[0];this.file=i,this.oldSrc=URL.createObjectURL(i),this.loadBoxShow=!1,this.form.reset()}},{key:"loadCanvas",value:function(){this.winWidth=this.main.offsetWidth,this.winHeight=this.main.offsetHeight,this.photoCutting=D(this.canvas,this.winWidth,this.winHeight,this.conso),this.setImg(this.oldSrc)}},{key:"setImg",value:function(t){var i;this.photoCutting&&t&&(null===(i=this.photoCutting)||void 0===i||i.setSrc(t))}},{key:"reset",value:function(){var t;this.photoCutting&&(null===(t=this.photoCutting)||void 0===t||t.photo.setSrc(this.oldSrc))}},{key:"updateNewData",value:function(){if(this.photoCutting){var t=this.photoCutting.photo.clip();this.newSrc=t.src,this.newBlob=t.file}}},{key:"close",value:function(){switch(this.status){case"clip":this.status="all";break;default:this.onCloseEvent()}}},{key:"sure",value:function(){switch(this.status){case"all":if(!this.photoCutting)return;this.updateNewData(),this.onChangeEvent(this.newBlob,this.newSrc);break;case"clip":if(!this.photoCutting)return;this.updateNewData(),this.photoCutting.photo.setSrc(this.newSrc),this.status="all";break}}},{key:"clip",value:function(){switch(this.status){case"all":this.status="clip";break;case"clip":this.status="all";break}}},{key:"rotate",value:function(t){var i;null===(i=this.photoCutting)||void 0===i||i.photo.rotate(t)}},{key:"flip",value:function(){var t,i=arguments.length>0&&void 0!==arguments[0]&&arguments[0];null===(t=this.photoCutting)||void 0===t||t.photo.flip(i)}},{key:"mounted",value:function(){this.loadCanvas(),this.photoCutting&&this.setImg(this.oldSrc)}},{key:"onChangeEvent",value:function(t,i){return{blob:t,base64:i}}},{key:"onCloseEvent",value:function(){}}]),e}(l["e"]);Object(u["a"])([Object(l["c"])({type:String,default:null,required:!1})],X.prototype,"src",void 0),Object(u["a"])([Object(l["c"])({type:Boolean,default:!0,required:!1})],X.prototype,"choose",void 0),Object(u["a"])([Object(l["d"])()],X.prototype,"form",void 0),Object(u["a"])([Object(l["d"])()],X.prototype,"main",void 0),Object(u["a"])([Object(l["d"])()],X.prototype,"canvas",void 0),Object(u["a"])([Object(l["d"])()],X.prototype,"conso",void 0),Object(u["a"])([Object(l["f"])("src")],X.prototype,"watchSrc",null),Object(u["a"])([Object(l["f"])("oldSrc")],X.prototype,"watchOldSrc",null),Object(u["a"])([Object(l["f"])("status")],X.prototype,"watchStatus",null),Object(u["a"])([Object(l["f"])("photoCutting.photo.isLoad")],X.prototype,"watchIsLoad",null),Object(u["a"])([Object(l["b"])("on-change")],X.prototype,"onChangeEvent",null),Object(u["a"])([Object(l["b"])("on-close")],X.prototype,"onCloseEvent",null),X=Object(u["a"])([l["a"]],X);var A=X,W=A,Y=(e("823b"),Object(p["a"])(W,w,m,!1,null,"218f700e",null)),H=Y.exports,U={install:function(t){t.component("vue-picture-cut",H)}};a["a"].config.productionTip=!1,a["a"].use(U),new a["a"]({render:function(t){return t(y)}}).$mount("#app")}});